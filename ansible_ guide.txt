1. Thiết lập tài khoản root ubuntu khi mới cài đặt
sudo -i
sudo passwd root
nano /etc/ssh/sshd_config --> PermitRootLogin yes
systemctl restart ssh

2. lấy code ansible về
git clone -b ubuntu22 https://git.dttt.vn/gitadmin/ansible.git

3. thiết lập ssh đến các server

# copy keygen tới máy được điều khiển


4. Cài đặt ansible
#cài trực tiếp: yêu cầu linux hỗ trợ python3 trở lên (ubuntu 20.xx trở lên)
chmod a+x start.sh
./start.sh
chọn cài đặt ansible

5. Đăng ký máy được điều khiển
#Lưu ý khi đặt tên group không được để trùng nhau với kể cả tên host, không để ký tự đặc biệt
# đăng ký thông tin máy được điều khiển vào file >> /etc/ansible/hosts theo mẫu sau
[tên_group]
<tên host> ansible_host=<ip máy host> ansible_port=22 ansible_user=root
# VD:
ansible ansible_host=192.168.253.140 ansible_port=22 ansible_user=root
[reachable]
ubuntu201 ansible_host=192.168.253.138 ansible_port=22 ansible_user=root
[worker]
ubuntu202 ansible_host=192.168.253.139 ansible_port=22 ansible_user=root

để áp dụng file host vừa nhập chạy:
./start
chọn update file hosts

4. chạy playbook
./start
chọn install swarm
install manager leader đầu tiên, sau đó manager reachable(nếu có), cuối cùng chạy worker










# Đang cập nhật ...
ansible-playbook sshport.yml -e hname=
# ssh-keygen -R $IP    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!
vi /etc/ansible/ansible.cfg
hostname
hostname -I
cat /etc/*release
3. Lấy thông tin máy được điều khiển
# Đặt tên mới cho server
hostnamectl set-hostname <new_name> 